"""""""""""""""""""" original contents""""""""""""""""""""""""

set nocompatible

"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""

" inoremap <C-s> <C-o>dw

""""""""""""""""" å…¨å±€è®¾ç½®"""""""""""""

" æ–‡ä»¶ç¼–ç 
set enc=utf-8
" ä¸è‡ªåŠ¨å¤‡ä»½ï¼Œç”Ÿæˆè®¨åŒçš„~
set nobackup
let mapleader=";"

" vim è‡ªèº«å‘½ä»¤è¡Œæ¨¡å¼æ™ºèƒ½è¡¥å…¨
set wildmenu

" å¤šå­—èŠ‚å­—ç¬¦æ˜¾ç¤º
set ambiwidth=double

""""""""""""""""""""""""""""""""""""""""""



""""""""""""""""" æ’ä»¶ç®¡ç†"""""""""""""""""

" å°† pathogen è‡ªèº«ä¹Ÿç½®äºç‹¬ç«‹ç›®å½•ä¸­ï¼Œéœ€æŒ‡å®šå…¶è·¯å¾„
runtime autoload/pathogen.vim
" è¿è¡Œ pathogen
execute pathogen#infect()

""""""""""""""""""""""""""""""""""""""""""



""""""""""""""""" æ˜¾ç¤º""""""""""""""""""""
" Maximize gvim window.
if has("gui_running")
    " GUI is running or is about to start.
    set lines=999 columns=999
endif

" è®¾ç½®å­—ä½“
" set guifont=YaHei_Consolas_Hybrid:h16:cANSI
set guifont=Monospace\ 16

""" é…è‰²æ–¹æ¡ˆ
set background=dark
colorscheme molokai

"" ç¦æ­¢æ˜¾ç¤ºæ»šåŠ¨æ¡ scroll bar
set guioptions-=l
set guioptions-=L
set guioptions-=r
set guioptions-=R
"" ç¦æ­¢æ˜¾ç¤ºèœå•å’Œå·¥å…·æ¡
" set guioptions-=m
set guioptions-=T

set laststatus=2 	" æ€»æ˜¯æ˜¾ç¤ºçŠ¶æ€æ 
set ruler			" æ˜¾ç¤ºå…‰æ ‡å½“å‰ä½ç½®
set nu	 			" å¼€å¯è¡Œå·æ˜¾ç¤º
set cursorline 		" é«˜äº®æ˜¾ç¤ºå½“å‰è¡Œ
set cursorcolumn	" é«˜äº®æ˜¾ç¤ºå½“å‰åˆ—
set nowrap 			" ç¦æ­¢æŠ˜è¡Œ

" è®¾ç½®çŠ¶æ€æ ä¸»é¢˜é£æ ¼
let g:Powerline_colorscheme='solarized256'

"" è¯­æ³•é«˜äº®
syntax enable 		" å¼€å¯è¯­æ³•é«˜äº®åŠŸèƒ½
syntax on 			" å…è®¸ç”¨æŒ‡å®šè¯­æ³•é«˜äº®é…è‰²æ–¹æ¡ˆæ›¿æ¢é»˜è®¤æ–¹æ¡ˆ

""" ç¼©è¿›
filetype indent on 	" è‡ªé€‚åº”ä¸åŒè¯­è¨€çš„æ™ºèƒ½ç¼©è¿›
set expandtab 		" å°†åˆ¶è¡¨ç¬¦æ‰©å±•ä¸ºç©ºæ ¼
set tabstop=4 		" è®¾ç½®ç¼–è¾‘æ—¶åˆ¶è¡¨ç¬¦å ç”¨ç©ºæ ¼æ•°
set shiftwidth=4 	" è®¾ç½®æ ¼å¼åŒ–æ—¶åˆ¶è¡¨ç¬¦å ç”¨ç©ºæ ¼æ•°
set softtabstop=4 	" è®© vim æŠŠè¿ç»­æ•°é‡çš„ç©ºæ ¼è§†ä¸ºä¸€ä¸ªåˆ¶è¡¨ç¬¦
"" ç¼©è¿›å¯è§†åŒ–æ’ä»¶ Indent Guides
let g:indent_guides_enable_on_vim_startup=1 		" éš vim è‡ªå¯åŠ¨
let g:indent_guides_start_level=2					" ä»ç¬¬äºŒå±‚å¼€å§‹å¯è§†åŒ–æ˜¾ç¤ºç¼©è¿›
let g:indent_guides_guide_size=1					" è‰²å—å®½åº¦
" å¿«æ·é”® im å¼€/å…³ç¼©è¿›å¯è§†åŒ–
nmap <silent> <Leader>im <Plug>IndentGuidesToggle

""" ä»£ç æŠ˜å 
set foldmethod=syntax 		" åŸºäºç¼©è¿›æˆ–è¯­æ³•è¿›è¡Œä»£ç æŠ˜å 
set nofoldenable 			" å¯åŠ¨ vim æ—¶å…³é—­æŠ˜å ä»£ç 

""" ç¦æ­¢ plugin: YouCompleteMe è¯­æ³•é”™è¯¯é«˜äº®æ˜¾ç¤º
let g:ycm_enable_diagnostic_signs = 0
let g:ycm_enable_diagnostic_highlighting = 0

""" Enable multiple highlights at startup ç”¨ä¸åŒé¢œè‰²é«˜äº®ä¸åŒå•è¯ highlights.vim
" æ¨¡æ‹Ÿé”®ç›˜æŒ‰é”®ï¼Œè¿™é‡Œä¸çŸ¥å¦‚ä½•å¼•ç”¨<leader>
autocmd VimEnter * nested :call feedkeys(";m")

""""""""""""""""""""""""""""""""""""""""""""



""""""""""""""""""" æ§åˆ¶ Control""""""""""""""""""

" set mouse=a 			" å¼€å¯é¼ æ ‡åŠŸèƒ½, å¯ä»¥æ‹–åŠ¨çª—å£å¤§å°
filetype on 			" å¼€å¯æ–‡ä»¶ç±»å‹ä¾¦æµ‹
filetype plugin on 		" æ ¹æ®ä¾¦æµ‹åˆ°çš„ä¸åŒç±»å‹åŠ è½½å¯¹åº”çš„æ’ä»¶

" å®šä¹‰å¿«æ·é”®å…³é—­å½“å‰åˆ†å‰²çª—å£
nmap <Leader>qt :q<CR>
" å®šä¹‰å¿«æ·é”®ä¿å­˜å½“å‰çª—å£å†…å®¹
nmap <Leader>w :w<CR>
" å®šä¹‰å¿«æ·é”®ä¿å­˜æ‰€æœ‰çª—å£å†…å®¹å¹¶é€€å‡º vim
nmap <Leader>WQ :wa<CR>:q<CR>
" ä¸åšä»»ä½•ä¿å­˜ï¼Œç›´æ¥é€€å‡º vim
" nmap <Leader>Q :qa!<CR>

""" Copy & Paste to system clipboard
" è®¾ç½®å¿«æ·é”®å°†é€‰ä¸­æ–‡æœ¬å—å¤åˆ¶è‡³ç³»ç»Ÿå‰ªè´´æ¿
vnoremap <Leader>y "*y
" è®¾ç½®å¿«æ·é”®å°†é€‰ä¸­æ–‡æœ¬å—å‰ªåˆ‡è‡³ç³»ç»Ÿå‰ªè´´æ¿
vnoremap <Leader>d "*d
" è®¾ç½®å¿«æ·é”®å°†ç³»ç»Ÿå‰ªè´´æ¿å†…å®¹ç²˜è´´è‡³vim åœ¨å…‰æ ‡ä¹‹å
nmap <Leader>p "*p
vmap <Leader>p "*p
" è®¾ç½®å¿«æ·é”®å°†ç³»ç»Ÿå‰ªè´´æ¿å†…å®¹ç²˜è´´è‡³vim åœ¨å…‰æ ‡ä¹‹å‰
nmap <Leader>P "*P
vmap <Leader>P "*P
" é€‰ä¸­åˆšåˆšæ›´æ”¹çš„å¦‚ç²˜è´´, select just changed as paste
nnoremap <expr> gp '`[' . strpart(getregtype(), 0, 1) . '`]'
" Copy / cut to sys clipboard
nmap <Leader>yiw "*yiw
nmap <Leader>yiW "*yiW
nmap <Leader>diw "*diw
nmap <Leader>diW "*diW
nmap <Leader>yy "*yy
nmap <Leader>dd "*dd

" åˆ é™¤è¡Œå°¾ç©ºæ ¼
nnoremap <Leader>rtw :%s/\s\+$//<CR>
" åˆ é™¤ç©ºè¡Œ
nnoremap <Leader>rel :g/^\s*$/d<CR>
" æ–­è¡Œ, split line
nnoremap K i<CR><Esc>

" å°†å¤–éƒ¨å‘½ä»¤ wmctrl æ§åˆ¶çª—å£æœ€å¤§åŒ–çš„å‘½ä»¤è¡Œå‚æ•°å°è£…æˆä¸€ä¸ª vim çš„å‡½æ•°
fun! ToggleFullscreen()
	call system("wmctrl -ir " . v:windowid . " -b toggle,fullscreen")
endf

nmap <C-F11> :set wrap! linebreak nolist<CR>
" å…¨å±å¼€/å…³å¿«æ·é”®
nnoremap <F11> :call ToggleFullscreen()<CR>
"autocmd VimEnter * call ToggleFullscreen() 		" å¯åŠ¨ vim æ—¶è‡ªåŠ¨å…¨å±

" inoremap <c-s> <c-o>:w<CR>			" ctrl-s Save ä¿å­˜åè¿”å›åŸ(æ’å…¥)æ¨¡å¼ only work in gvim


""" å¤šæ–‡æ¡£ç¼–è¾‘ MiniBufExplorer
" disable auto open
let g:miniBufExplorerAutoStart = 0
let g:miniBufExplMaxSize = 1

" æ˜¾ç¤º/éšè— MiniBufExplorer çª—å£
nmap <Leader>bl :MBEToggle<CR>
nnoremap <S-F10> :MBEToggle<CR>
nnoremap <C-F10> :TagbarToggle<CR>
" close tab
nmap <leader>ct :MBEbd<CR>
"" buffer åˆ‡æ¢å¿«æ·é”®
nnoremap <C-Tab> :MBEbn<cr>
nnoremap <C-S-Tab> :MBEbp<cr>

""" plugin: NERDTree æ–‡ä»¶æµè§ˆå™¨
" autocmd VimEnter * nested :NERDTree				" å¯åŠ¨vimè‡ªåŠ¨å¼€å¯

""" Move cursor to Main window
autocmd VimEnter * nested :wincmd h 				" left to main window
" autocmd VimEnter * nested :wincmd j 				" down to main


""" å·¥ç¨‹æ–‡ä»¶æµè§ˆ plugin: NERDTree
" ä½¿ç”¨ NERDTree æ’ä»¶æŸ¥çœ‹å·¥ç¨‹æ–‡ä»¶ã€‚è®¾ç½®å¿«æ·é”®ï¼Œé€Ÿè®°ï¼šfile list
nmap <Leader>fl :NERDTreeToggle<CR>
nmap <Leader><Leader>fl :NERDTree .<CR>
nmap <F10> :NERDTreeToggle<CR>
let NERDTreeWinSize=40					" è®¾ç½® NERDTree å­çª—å£å®½åº¦
let NERDTreeWinPos="right"				" è®¾ç½® NERDTree å­çª—å£ä½ç½®
" let NERDTreeShowHidden=1				" æ˜¾ç¤ºéšè—æ–‡ä»¶
let NERDTreeMinimalUI=1					" NERDTree å­çª—å£ä¸­ä¸æ˜¾ç¤ºå†—ä½™å¸®åŠ©ä¿¡æ¯
let NERDTreeAutoDeleteBuffer=1			" åˆ é™¤æ–‡ä»¶æ—¶è‡ªåŠ¨åˆ é™¤æ–‡ä»¶å¯¹åº” buffer

" F4 å…³é—­å½“å‰æ ‡ç­¾
nnoremap <F4> :MBEbd<CR> 
""" BufOnly.vim
" close all buffers except this
noremap <S-F4> :BufOnly<CR>

""" åˆ†å‰²çª—å£ split window
nmap <leader>sp :sp<CR><C-w><Down>
nmap <leader>vs :vs<CR><C-w><Right>

" scroll horizontally
nmap <S-C-Left> 5zh
nmap <S-C-Right> 5zl
nmap <S-Left> zH
nmap <S-Right> zL

" Number of lines by Ctrl+u and Ctrl+d
" set scroll=5
""" change scroll to 5 line one time scroll step length æ­¥é•¿
nmap <C-U> 10<C-Y>
nmap <C-D> 10<C-E>

nmap <leader>qf :call ToggleQuickfixList()<CR>

nmap <leader>qp  :colder<CR>
nmap <leader>qn  :cnewer<CR>
nmap <leader>lp  :lolder<CR>
nmap <leader>ln  :lnewer<CR>
nmap <C-k>  :cprev<CR>zz
nmap <C-j>  :cnext<CR>zz
nmap <C-a>  :lprev<CR>zz
nmap <C-z>  :lnext<CR>zz

"""""""""""""""""""""""""""""""""""""""""""""""""



""""""""""""""""""" æŸ¥æ‰¾æ›¿æ¢ Find & Replace""""""""""""""""""

" å–æ¶ˆæœç´¢ç»“æœé«˜äº®æ˜¾ç¤ºå¹¶åˆ·æ–°å±å¹•
nnoremap <silent> <C-l> :nohl<CR><C-l>
set incsearch 	" å¼€å¯å®æ—¶æœç´¢åŠŸèƒ½
set ignorecase 	" æœç´¢æ—¶å¤§å°å†™ä¸æ•æ„Ÿ
set hlsearch 	" é«˜äº®æ˜¾ç¤ºæœç´¢ç»“æœ

""" é€‰å–å†…æŸ¥æ‰¾
function! RangeSearch(direction)
  call inputsave()
  let g:srchstr = input(a:direction)
  call inputrestore()
  if strlen(g:srchstr) > 0
    let g:srchstr = g:srchstr.
          \ '\%>'.(line("'<")-1).'l'.
          \ '\%<'.(line("'>")+1).'l'
  else
    let g:srchstr = ''
  endif
endfunction
vnoremap <silent> / :<C-U>call RangeSearch('/')<CR>:if strlen(g:srchstr) > 0\|exec '/'.g:srchstr\|endif<CR>
vnoremap <silent> ? :<C-U>call RangeSearch('?')<CR>:if strlen(g:srchstr) > 0\|exec '?'.g:srchstr\|endif<CR>

""" plugin: ack
"" shift: search all in root dir recursively
"" ctrl: search in the file dir recursively
vmap * y/\<\><Left><Left><C-r>0<CR>
noremap <leader>sa :Ack! -rkw <cword><CR>
nmap <S-F3> yiw:Ack! -rkw ""<Left><C-r>0<CR>/\<\><Left><Left><C-r>0<CR>
vmap <S-F3> y:Ack! -rkw ""<Left><C-r>0<CR>/\<\><Left><Left><C-r>0<CR>
noremap <leader>sc :Ack! -w <cword> %<CR>
nmap <F3> yiw:Ack! -rkw "" %<Left><Left><Left><C-r>0<CR>/\<\><Left><Left><C-r>0<CR>
vmap <F3> y:Ack! -rkw "" %<Left><Left><Left><C-r>0<CR>/\<\><Left><Left><C-r>0<CR>
noremap <leader>sd :Ack! -rkw <cword> %:h<CR>
nmap <C-F3> yiw:Ack! -rkw "" %:h<Left><Left><Left><Left><Left><C-r>0<CR>/\<\><Left><Left><C-r>0<CR>
vmap <C-F3> y:Ack! -rkw "" %:h<Left><Left><Left><Left><Left><C-r>0<CR>/\<\><Left><Left><C-r>0<CR>
" noremap <F2> :Ack! -i "" %<Left><Left><Left>
nmap <F2> :Grep -iw  %<Left><Left>
nmap <S-F2> :Ack! -rkiw ""<Left>
nmap <C-F2> :Ack! -rkiw "" %:h<Left><Left><Left><Left><Left>
nmap <leader>gr :Rgrep -wi  *<Left><Left>
nmap <leader>ga :RgrepAdd -wi  *<Left><Left>
nmap <leader>cgr :Rgrep -wi  *.h *.hpp *.cpp *.cc *.c *.cxx<Home><Right><Right><Right><Right><Right><Right><Right><Right><Right><Right>
nmap <leader>jgr :Rgrep -wi  *.java<Home><Right><Right><Right><Right><Right><Right><Right><Right><Right><Right>
" nmap <leader>pgr :Rgrep -wi  *.py<Home><Right><Right><Right><Right><Right><Right><Right><Right><Right><Right>
nmap <leader>/ /\<\><Left><Left>
" æœç´¢å½“å‰é€‰ä¸­æ–‡æœ¬ search selected
vmap <Leader>/ y/\<\><Left><Left><C-r>0<CR>
""" æ›¿æ¢
vnoremap <F5> :s/<C-r>///g<Left><Left>
nnoremap <F5> :s/<C-r>///g<Left><Left>
vnoremap <S-F5> :%s/<C-r>///g<Left><Left>
nnoremap <S-F5> :%s/<C-r>///g<Left><Left>

" close quickfix window
nnoremap <leader>cq :ccl<CR>

"""""""""""""""""""""""""""""""""""""""""""""""""



"""""""""""""""""""""""""" ä»£ç å¯¼èˆª Code Nav""""""""""""""""""""""""""""
""""""" ctags
" See http://vim.wikia.com/wiki/Single_tags_file_for_a_source_tree
set tags=tags;
nmap <Leader>ts yiw:ts <c-r>0<CR>/\<<C-r>0\><CR>
vmap <Leader>ts y:ts /<c-r>0<CR>/\<<C-r>0\><CR>
nmap <Leader>lt yiw:ltag <c-r>0<CR>:lopen<CR>/\<<C-r>0\><CR>
vmap <Leader>lt y:ltag /<c-r>0<CR>:lopen<CR>/\<<C-r>0\><CR>
"""""""""""""

""" æ¥å£ä¸å®ç°å¿«é€Ÿåˆ‡æ¢ plugin: a.vim
" *.cpp å’Œ *.h é—´åˆ‡æ¢
nmap <Leader>ch :A<CR>
" å­çª—å£ä¸­æ˜¾ç¤º *.cpp æˆ– *.h
nmap <Leader>sch :AS<CR>

""" è¿™ä¸¤ä¸ªåŠŸèƒ½æ˜¯vim tagåŠŸèƒ½ä¸€éƒ¨åˆ†
" æ­£å‘éå†åŒåæ ‡ç­¾
nmap <Leader>tn :tnext<CR>
" åå‘éå†åŒåæ ‡ç­¾
nmap <Leader>tp :tprevious<CR>

""" åŸºäºè¯­ä¹‰çš„ä»£ç å¯¼èˆª plugin: YouCompleteMe
nnoremap <leader>jd :YcmCompleter GoToDeclaration<CR>
" åªèƒ½æ˜¯ #include æˆ–å·²æ‰“å¼€çš„æ–‡ä»¶
nnoremap <leader>je :YcmCompleter GoToDefinition<CR>

""" æ ‡ç­¾åˆ—è¡¨ plugin: tagbar
" é»˜è®¤æŒ‰æºæ–‡ä»¶ä¸­å®šä¹‰é¡ºåºè€Œä¸æ˜¯å­—æ¯
let g:tagbar_sort = 0
" è®¾ç½® tagbar å­çª—å£çš„ä½ç½®å‡ºç°åœ¨ä¸»ç¼–è¾‘åŒºçš„å·¦è¾¹
let tagbar_left=1
" è®¾ç½®æ˜¾ç¤ºï¼éšè—æ ‡ç­¾åˆ—è¡¨å­çª—å£çš„å¿«æ·é”®ã€‚é€Ÿè®°ï¼štag list
nnoremap <Leader>tl :TagbarToggle<CR>
" è®¾ç½®æ ‡ç­¾å­çª—å£çš„å®½åº¦
let tagbar_width=25
" tagbar å­çª—å£ä¸­ä¸æ˜¾ç¤ºå†—ä½™å¸®åŠ©ä¿¡æ¯
let g:tagbar_compact=1
" è®¾ç½® ctags å¯¹å“ªäº›ä»£ç å…ƒç´ ç”Ÿæˆæ ‡ç­¾
let g:tagbar_type_cpp = {
     \ 'ctagstype' : 'c++',
     \ 'kinds'     : [
         \ 'd:macros:1',
         \ 'g:enums',
         \ 't:typedefs:0:0',
         \ 'e:enumerators:0:0',
         \ 'n:namespaces',
         \ 'c:classes',
         \ 's:structs',
         \ 'u:unions',
         \ 'f:functions',
         \ 'm:members:0:0',
         \ 'v:global:0:0',
         \ 'x:external:0:0',
         \ 'l:local:0:0'
     \ ],
     \ 'sro'        : '::',
     \ 'kind2scope' : {
         \ 'g' : 'enum',
         \ 'n' : 'namespace',
         \ 'c' : 'class',
         \ 's' : 'struct',
         \ 'u' : 'union'
     \ },
     \ 'scope2kind' : {
         \ 'enum'      : 'g',
         \ 'namespace' : 'n',
         \ 'class'     : 'c',
         \ 'struct'    : 's',
         \ 'union'     : 'u'
     \ }
\ }

" autocmd VimEnter * nested :TagbarOpen				" å¯åŠ¨vimè‡ªåŠ¨å¼€å¯
" å¯åŠ¨vimè‡ªåŠ¨å¼€å¯ä»…å¯¹æ‰€æ”¯æŒæ–‡ä»¶ç±»å‹
autocmd VimEnter * nested :call tagbar#autoopen(1)
" nmap <Tab> <Return>                            " é˜²æ­¢é¼ æ ‡åŒå‡»å¯¼è‡´ç¨‹åºå´©æºƒCtrl-I ä¸èƒ½å·¥ä½œ

""" cscope
" set cst					" ç”¨cscopeå®ç°ctagsåŠŸèƒ½ cscopetag
" autocmd VimEnter * nested :silent cs add cscope.out
nnoremap <leader>fa :call cscope#findInteractive(expand('<cword>'))<CR>
nnoremap <leader>ll :call ToggleLocationList()<CR>
" s: Find this C symbol
nnoremap  <leader>fs yiw:call cscope#find('s', expand('<cword>'))<CR>/\<\><Left><Left><C-r>0<CR>
" g: Find this definition
nnoremap  <leader>fg yiw:call cscope#find('g', expand('<cword>'))<CR>/\<\><Left><Left><C-r>0<CR>
" d: Find functions called by this function
nnoremap  <leader>fd :call cscope#find('d', expand('<cword>'))<CR>
" c: Find functions calling this function
nnoremap  <leader>fc :call cscope#find('c', expand('<cword>'))<CR>
" t: Find this text string
nnoremap  <leader>ft yiw:call cscope#find('t', expand('<cword>'))<CR>/\<\><Left><Left><C-r>0<CR>
vnoremap  <leader>ft y:call cscope#find('t', expand(''))<Left><Left><Left><C-r>0<CR>/\<\><Left><Left><C-r>0<CR>
" e: Find this egrep pattern
nnoremap  <leader>fe yiw:call cscope#find('e', expand('<cword>'))<CR>/\<\><Left><Left><C-r>0<CR>
vnoremap  <leader>fe y:call cscope#find('e', expand('<cword>'))<CR>/\<\><Left><Left><C-r>0<CR>
" f: Find this file
nnoremap  <leader>ff :call cscope#find('f', expand('<cword>'))<CR>
" i: Find files #including this file
nnoremap  <leader>fi :call cscope#find('i', expand('<cword>'))<CR>
" æ›´æ–°æ•°æ®åº“
" nmap <F12> :cs kill -1<CR>:silent !myfind *.h*.hpp*.c*.cc*.cpp > cscope.files<CR>:silent !cscope -bkq -i cscope.files<CR>:cs add cscope.out<CR>:silent !cat cscope.files \| xargs ctags --c++-kinds=+p+l+x+c+d+e+f+g+m+n+s+t+u+v --fields=+liaS --extra=+q<CR>:NeoCompleteTagMakeCache<CR><CR>
" nmap <F12> :cs kill -1<CR>:silent !myfind *.h*.hpp*.c*.cc*.cpp > cscope.files<CR>:silent !cscope -bkq -i cscope.files<CR>:cs add cscope.out<CR>:silent !cat cscope.files \| xargs ctags --c++-kinds=+p+l+x+c+d+e+f+g+m+n+s+t+u+v --fields=+liaS --extra=+q<CR>:NeoCompleteTagMakeCache<CR>
" nmap <F12> :cs kill -1<CR>:!myfind *.h*.hpp*.c*.cc*.cpp > cscope.files<CR>:!cscope -bkq -i cscope.files<CR>:cs add cscope.out<CR><CR>
nnoremap <F12> :silent !ctags -R --c++-kinds=+p+l+x+c+d+e+f+g+m+n+s+t+u+v --fields=+liaS --extra=+q .<CR>


""" ä»£ç æ”¶è— vim-signature
"" è‡ªå®šä¹‰ vim-signature å¿«æ·é”®
"let g:SignatureMap = {
        "\ 'Leader'             :  "m",
        "\ 'PlaceNextMark'      :  "m,",
        "\ 'ToggleMarkAtLine'   :  "m.",
        "\ 'PurgeMarksAtLine'   :  "m-",
        "\ 'DeleteMark'         :  "dm",
        "\ 'PurgeMarks'         :  "mda",
        "\ 'PurgeMarkers'       :  "m<BS>",
        "\ 'GotoNextLineAlpha'  :  "']",
        "\ 'GotoPrevLineAlpha'  :  "'[",
        "\ 'GotoNextSpotAlpha'  :  "`]",
        "\ 'GotoPrevSpotAlpha'  :  "`[",
        "\ 'GotoNextLineByPos'  :  "]'",
        "\ 'GotoPrevLineByPos'  :  "['",
        "\ 'GotoNextSpotByPos'  :  "mn",
        "\ 'GotoPrevSpotByPos'  :  "mp",
        "\ 'GotoNextMarker'     :  "[+",
        "\ 'GotoPrevMarker'     :  "[-",
        "\ 'GotoNextMarkerAny'  :  "]=",
        "\ 'GotoPrevMarkerAny'  :  "[=",
        "\ 'ListLocalMarks'     :  "ms",
        "\ 'ListLocalMarkers'   :  "m?"
        "\ }

""" code folding
set fdm=syntax

""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""



""""""""""""""""""""""""""" ä»£ç è‡ªåŠ¨å®Œæˆ Auto Complete"""""""""""""""""""""""""""

""" UltiSnips çš„ tab é”®ä¸ YCM å†²çªï¼Œé‡æ–°è®¾å®š
let g:UltiSnipsSnippetDirectories="vim-snippets/UltiSnips/"
let g:UltiSnipsExpandTrigger="<leader><tab>"
let g:UltiSnipsJumpForwardTrigger="<leader><tab>"
let g:UltiSnipsJumpBackwardTrigger="<leader><s-tab>"


""" YouCompleteMe
"" YCM è¡¥å…¨èœå•é…è‰²
" èœå•
highlight Pmenu ctermfg=2 ctermbg=3 guifg=#005f87 guibg=#EEE8D5
" é€‰ä¸­é¡¹
highlight PmenuSel ctermfg=2 ctermbg=3 guifg=#AFD700 guibg=#106900

" è¡¥å…¨åŠŸèƒ½åœ¨æ³¨é‡Šä¸­åŒæ ·æœ‰æ•ˆ
let g:ycm_complete_in_comments=1
" å…è®¸ vim åŠ è½½ .ycm_extra_conf.py æ–‡ä»¶ï¼Œä¸å†æç¤º
let g:ycm_confirm_extra_conf=0
" å¼€å¯ YCM æ ‡ç­¾è¡¥å…¨å¼•æ“
let g:ycm_collect_identifiers_from_tags_files=1
" å›è½¦å³é€‰ä¸­å½“å‰é¡¹ ycm
inoremap <expr><CR> pumvisible() ? "\<C-y>" : "\<CR>"
" set tags+=/usr/include/c++/4.8/stdcpp.tags 		 			" å¼•å…¥ C++ æ ‡å‡†åº“ tags
" YCM é›†æˆ OmniCppComplete è¡¥å…¨å¼•æ“ï¼Œè®¾ç½®å…¶å¿«æ·é”®
inoremap <leader>; <C-x><C-o>
" è¡¥å…¨å†…å®¹ä¸ä»¥åˆ†å‰²å­çª—å£å½¢å¼å‡ºç°ï¼Œåªæ˜¾ç¤ºè¡¥å…¨åˆ—è¡¨
set completeopt-=preview
" ä»ç¬¬ä¸€ä¸ªé”®å…¥å­—ç¬¦å°±å¼€å§‹ç½—åˆ—åŒ¹é…é¡¹
let g:ycm_min_num_of_chars_for_completion=1
" ç¦æ­¢ç¼“å­˜åŒ¹é…é¡¹ï¼Œæ¯æ¬¡éƒ½é‡æ–°ç”ŸæˆåŒ¹é…é¡¹
let g:ycm_cache_omnifunc=0
" è¯­æ³•å…³é”®å­—è¡¥å…¨
let g:ycm_seed_identifiers_with_syntax=1
" å…¨å±€é…ç½®æ–‡ä»¶
let ycm_global_ycm_extra_conf="~/.vim/bundle/YouCompleteMe/third_party/ycmd/examples/.ycm_extra_conf.py"

""" æ³¨é‡Š NERDCommenter
" æ³¨é‡Šç¬¦åè·Ÿä¸€ä¸ªç©ºæ ¼
let NERDSpaceDelims = 1
nmap <F8> <leader>ci
vmap <F8> <leader>ci
nmap <S-F8> <leader>cs
vmap <S-F8> <leader>cs

""" doxygen
nnoremap <leader><leader>dox :Dox<CR>
vnoremap <leader><leader>dox :Dox<CR>

""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""


"""""""""""Chapter ä»£ç æ’ç‰ˆ""""""""""""""""""""""

"""""""Easy Align
" Start interactive EasyAlign in visual mode (e.g. vip<Enter>)
vmap <Enter> <Plug>(EasyAlign)
" Start interactive EasyAlign for a motion/text object (e.g. gaip)
nmap ga <Plug>(EasyAlign)

"""""""""""""""""""""""""""""""""""""""""""""""""

""""""""""" Section vim-bookmarks""""""""""""""""""

nmap <Leader>mm <Plug>BookmarkToggle
nmap <Leader>mi <Plug>BookmarkAnnotate
nmap <Leader>ma <Plug>BookmarkShowAll
nmap <Leader>mn <Plug>BookmarkNext
nmap <Leader>mp <Plug>BookmarkPrev
nmap <Leader>mc <Plug>BookmarkClear
nmap <Leader>mx <Plug>BookmarkClearAll
nmap <Leader>mkk <Plug>BookmarkMoveUp
nmap <Leader>mjj <Plug>BookmarkMoveDown

let g:bookmark_no_default_key_mappings = 1
let g:bookmark_auto_save = 1
let g:bookmark_save_per_working_dir = 1
let g:bookmark_highlight_lines = 1
" Turn off the warning when clearing all bookmarks
let g:bookmark_show_warning = 0
" Turn off the warning when toggling to clear a bookmark with annotation
let g:bookmark_show_toggle_warning = 0
" Turn on vertical line centering when jumping to bookmark
let g:bookmark_center = 1
" use location list
let g:bookmark_location_list = 1
" highlight BookmarkSign ctermbg=NONE ctermfg=160
" highlight BookmarkLine ctermbg=194 ctermfg=NONE
let g:bookmark_sign = 'â™¥'
let g:bookmark_highlight_lines = 1

call unite#custom#profile('source/vim_bookmarks', 'context', {
    \   'winheight': 50,
    \   'direction': 'botright',
    \   'start_insert': 0,
    \   'keep_focus': 1,
    \   'no_quit': 1,
    \ })

"""""""""""""""""""""""""""""""""""""""""""""""""""

""""""""""""""""" Unite""""""""""""""""""""""""""""

nnoremap <Leader>ub :Unite buffer<CR>
nnoremap <Leader>uf :Unite file<CR>
nnoremap <Leader>ur :Unite file_rec<CR>
nnoremap <Leader>us :UniteResume<CR>
nnoremap <Leader>un :UniteNext<CR>
nnoremap <Leader>up :UnitePrevious<CR>

"""""""""""""""""""""""""""""""""""""""""""""""""""

""""""""""""""""""""""CtrlP"""""""""""""""""""""""""""""
let g:ctrlp_cmd = 'CtrlP .'
" Ctrl - z select multi files and ctrl - o open them in hidden buffers
let g:ctrlp_open_multiple_files = 'i'

"""""""""""""""""""""""""""""""""""""""""""""""""""


"""""""""""""""""""""Others""""""""""""""""""""""""
" åˆ‡æ¢è·¯å¾„åˆ°å½“å‰æ‰€ç¼–è¾‘æ–‡ä»¶æ‰€åœ¨ç›®å½•
nnoremap <Leader>cwd :cd %:p:h<CR>

"""""""""""""""""""""""""""""""""""""""""""""""""""


"""""""""""""""""""""Unicode""""""""""""""""""""""
" See https://en.wikipedia.org/wiki/Miscellaneous_Symbols
" 
" char â™¥
imap <Leader>ul <C-q>u2665
" char ğŸ”´
imap <Leader>ur <C-q>U0001f534
" char ğŸ”µ
imap <Leader>ub <C-q>U0001f535
" char â­•
imap <Leader>uhr <C-q>u2b55
" char â˜…
imap <Leader>u* <C-q>u2605
" char â˜†
imap <Leader>uh* <C-q>u2606
" char â™¬
imap <Leader>um <C-q>u266c
" char â›©
imap <Leader>uj <C-q>u26e9
"""""""""""""""""""""""""""""""""""""""""""""""""""


" æ›¿æ¢

" æ›¿æ¢å‡½æ•°ã€‚å‚æ•°è¯´æ˜ï¼š
" confirmï¼šæ˜¯å¦æ›¿æ¢å‰é€ä¸€ç¡®è®¤
" wholewordï¼šæ˜¯å¦æ•´è¯åŒ¹é…
" replaceï¼šè¢«æ›¿æ¢å­—ç¬¦ä¸²
function! Replace(confirm, wholeword, replace)
    wa
    let flag = ''
    if a:confirm
        let flag .= 'gec'
    else
        let flag .= 'ge'
    endif
    let search = ''
    if a:wholeword
        let search .= '\<' . escape(expand('<cword>'), '/\.*$^~[') . '\>'
    else
        let search .= expand('<cword>')
    endif
    let replace = escape(a:replace, '/\&~')
    execute 'argdo %s/' . search . '/' . replace . '/' . flag . '| update'
endfunction
" ä¸ç¡®è®¤ã€éæ•´è¯
nnoremap <Leader>R :call Replace(0, 0, input('Replace '.expand('<cword>').' with: '))<CR>
" ä¸ç¡®è®¤ã€æ•´è¯
nnoremap <Leader>rw :call Replace(0, 1, input('Replace '.expand('<cword>').' with: '))<CR>
" ç¡®è®¤ã€éæ•´è¯
nnoremap <Leader>rc :call Replace(1, 0, input('Replace '.expand('<cword>').' with: '))<CR>
" ç¡®è®¤ã€æ•´è¯
nnoremap <Leader>rcw :call Replace(1, 1, input('Replace '.expand('<cword>').' with: '))<CR>
nnoremap <Leader>rwc :call Replace(1, 1, input('Replace '.expand('<cword>').' with: '))<CR>



" <<

" é™æ€åˆ†æå™¨ syntastic é”™è¯¯æ ‡è¯†
let g:syntastic_error_symbol = 'âœ—'
let g:syntastic_warning_symbol = 'âš '

" >>
" ç”±æ¥å£å¿«é€Ÿç”Ÿæˆå®ç°æ¡†æ¶

" è®¾ç½® pullproto.pl è„šæœ¬è·¯å¾„
let g:protodefprotogetter='~/.vim/bundle/vim-protodef/pullproto.pl'

" æˆå‘˜å‡½æ•°çš„å®ç°é¡ºåºä¸å£°æ˜é¡ºåºä¸€è‡´
let g:disable_protodef_sorting=1


" ç¯å¢ƒæ¢å¤

" è®¾ç½®ç¯å¢ƒä¿å­˜é¡¹
set sessionoptions="blank,globals,localoptions,tabpages,sesdir,folds,help,options,resize,winpos,winsize"

" ä¿å­˜ undo å†å²
set undodir=~/.undo_history/
set undofile

" ä¿å­˜å¿«æ·é”®
"nnoremap <leader>ss :mksession! my.vim<cr> :wviminfo! my.viminfo<cr>
nnoremap <leader>ss :mksession! my.vim<cr>

" æ¢å¤å¿«æ·é”®
"nnoremap <leader>rs :source my.vim<cr> :rviminfo my.viminfo<cr>
nnoremap <leader>rs :source my.vim<cr>

" è°ƒç”¨ gundo æ ‘
nnoremap <Leader>ud :GundoToggle<CR>

" >>
" web å‰ç«¯

" surrond æ·»åŠ  <p> å…ƒç´ çš„å¿«æ·é”®
" nmap <Leader>ap yss<p><CR>

" å¯¹ HTML å…ƒç´ è¿›è¡Œè½¬ä¹‰ï¼š< -> &lt;ã€> -> &gt;ã€& -> &amp;ã€ç©ºæ ¼ -> &nbsp;ã€è¡Œå°¾æ·»åŠ  <br />
" å…ˆåé¡ºåºæ•æ„Ÿ
" function HtmlEscape()
    " retab<CR>
    " silent s/&/\&amp;/eg
    " silent s/</\&lt;/eg
    " silent s/>/\&gt;/eg
    " silent s/ /\&nbsp;/eg
    " silent s/$/<br \/>/eg
" endfunction
" vnoremap <Leader>he :call HtmlEscape()<CR>

" <<

" let OmniCpp_DefaultNamespaces = ["_GLIBCXX_STD"]



